<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Producer Tasks - Real-Time Collaboration</title>
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore-compat.js"></script>

    <style>
        body {
            font-family: system-ui, -apple-system, sans-serif;
        }

        .status {
            position: fixed;
            top: 10px;
            right: 10px;
            padding: 8px 12px;
            border-radius: 20px;
            font-size: 12px;
            z-index: 1000;
        }

        .online {
            background: #10b981;
            color: white;
        }

        .offline {
            background: #ef4444;
            color: white;
        }
    </style>
</head>

<body class="bg-gray-50 min-h-screen py-8 px-4">
    <div id="status" class="status offline">‚ö†Ô∏è Connecting...</div>

    <div class="max-w-4xl mx-auto">
        <header class="text-center mb-8">
            <h1 class="text-4xl font-bold text-gray-900 mb-2">üé§ Producer Tasks</h1>
            <p class="text-gray-600">Real-Time Collaborative Task Management</p>
            <p class="text-sm text-gray-500 mt-1">Share this URL - all changes sync instantly!</p>
        </header>

        <!-- Firebase Setup Notice -->
        <div id="setupNotice" class="bg-yellow-50 border border-yellow-200 rounded-lg p-4 mb-6 hidden">
            <h3 class="font-semibold text-yellow-800 mb-2">üîß Firebase Setup Required</h3>
            <p class="text-sm text-yellow-700 mb-2">To enable real-time collaboration, add your Firebase config to the
                code (line ~30)</p>
            <p class="text-xs text-yellow-600">Currently using localStorage - data is only saved on this device.</p>
        </div>
        const firebaseConfig = {
        apiKey: "AIzaSyDJswTUWjB0q5rO_sBZERS2u0HM_iFnw3M",
        authDomain: "producer-tasks.firebaseapp.com",
        projectId: "producer-tasks",
        storageBucket: "producer-tasks.firebasestorage.app",
        messagingSenderId: "762020116589",
        appId: "1:762020116589:web:e6ea1023504621c4746764"
        };
        <!-- Add Task -->
        <div class="bg-white rounded-lg shadow p-6 mb-6">
            <h2 class="text-xl font-semibold mb-4">Add New Task</h2>
            <form id="taskForm" class="space-y-4">
                <input type="text" id="title" placeholder="Task title" required
                    class="w-full px-3 py-2 border rounded-md">
                <input type="text" id="assignee" placeholder="Assignee" required
                    class="w-full px-3 py-2 border rounded-md">
                <select id="category" class="w-full px-3 py-2 border rounded-md">
                    <option value="Venue">Venue</option>
                    <option value="Comedians">Comedians</option>
                    <option value="Marketing">Marketing</option>
                    <option value="Equipment">Equipment</option>
                    <option value="Misc">Misc</option>
                </select>
                <button type="submit" class="w-full bg-blue-600 text-white py-2 rounded-md hover:bg-blue-700">Add
                    Task</button>
            </form>
        </div>

        <!-- Tasks List -->
        <div class="bg-white rounded-lg shadow p-6">
            <h2 class="text-xl font-semibold mb-4">Tasks</h2>
            <div id="tasksList"></div>
        </div>
    </div>

    <script>
        // ========== FIREBASE CONFIG - REPLACE WITH YOUR VALUES ==========
        const firebaseConfig = {
            apiKey: "YOUR_API_KEY",
            authDomain: "YOUR_PROJECT.firebaseapp.com",
            projectId: "YOUR_PROJECT_ID",
            storageBucket: "YOUR_PROJECT.appspot.com",
            messagingSenderId: "YOUR_SENDER_ID",
            appId: "YOUR_APP_ID"
        };
        // ================================================================

        let db, isOnline = false;

        // Initialize Firebase
        function initFirebase() {
            if (firebaseConfig.apiKey === "YOUR_API_KEY") {
                document.getElementById('setupNotice').classList.remove('hidden');
                updateStatus(false, 'Offline Mode');
                return false;
            }

            try {
                firebase.initializeApp(firebaseConfig);
                db = firebase.firestore();
                isOnline = true;
                updateStatus(true, 'Real-Time Sync');
                return true;
            } catch (e) {
                console.error('Firebase init failed:', e);
                updateStatus(false, 'Offline Mode');
                return false;
            }
        }

        function updateStatus(online, text) {
            const status = document.getElementById('status');
            status.textContent = online ? `üü¢ ${text}` : `‚ö†Ô∏è ${text}`;
            status.className = `status ${online ? 'online' : 'offline'}`;
        }

        // LocalStorage fallback
        function getLS(key, fallback) {
            try {
                return JSON.parse(localStorage.getItem(key)) || fallback;
            } catch {
                return fallback;
            }
        }

        function setLS(key, value) {
            localStorage.setItem(key, JSON.stringify(value));
        }

        // Tasks
        let tasks = [];

        function renderTasks() {
            const container = document.getElementById('tasksList');
            if (tasks.length === 0) {
                container.innerHTML = '<p class="text-gray-500 text-center py-4">No tasks yet</p>';
                return;
            }

            // Group by category
            const grouped = {};
            tasks.forEach(t => {
                const cat = t.category || 'Misc';
                if (!grouped[cat]) grouped[cat] = [];
                grouped[cat].push(t);
            });

            let html = '';
            Object.keys(grouped).sort().forEach(cat => {
                html += `<div class="mb-4">
                    <h3 class="font-semibold text-gray-700 mb-2">${cat}</h3>`;
                grouped[cat].forEach(t => {
                    html += `<div class="border-b py-2 flex justify-between items-center">
                        <div class="flex-1">
                            <p class="${t.completed ? 'line-through text-gray-500' : ''}">${t.title}</p>
                            <small class="text-gray-600">${t.assignee}</small>
                        </div>
                        <div class="flex gap-2">
                            <input type="checkbox" ${t.completed ? 'checked' : ''} 
                                onclick="toggleTask('${t.id}')" class="w-5 h-5 cursor-pointer">
                            <button onclick="deleteTask('${t.id}')" class="text-red-600 text-sm">Delete</button>
                        </div>
                    </div>`;
                });
                html += '</div>';
            });
            container.innerHTML = html;
        }

        // Add task
        document.getElementById('taskForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            const task = {
                id: Date.now().toString(36) + Math.random().toString(36).slice(2),
                title: document.getElementById('title').value,
                assignee: document.getElementById('assignee').value,
                category: document.getElementById('category').value,
                completed: false,
                createdAt: Date.now()
            };

            if (isOnline) {
                await db.collection('tasks').doc(task.id).set(task);
            } else {
                tasks.push(task);
                setLS('tasks', tasks);
                renderTasks();
            }

            e.target.reset();
        });

        // Toggle task
        window.toggleTask = async (id) => {
            if (isOnline) {
                const task = tasks.find(t => t.id === id);
                if (task) {
                    await db.collection('tasks').doc(id).update({ completed: !task.completed });
                }
            } else {
                tasks = tasks.map(t => t.id === id ? { ...t, completed: !t.completed } : t);
                setLS('tasks', tasks);
                renderTasks();
            }
        };

        // Delete task
        window.deleteTask = async (id) => {
            if (!confirm('Delete this task?')) return;

            if (isOnline) {
                await db.collection('tasks').doc(id).delete();
            } else {
                tasks = tasks.filter(t => t.id !== id);
                setLS('tasks', tasks);
                renderTasks();
            }
        };

        // Initialize
        if (initFirebase()) {
            // Real-time listener
            db.collection('tasks').onSnapshot(snapshot => {
                tasks = snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));
                renderTasks();
            });
        } else {
            // Offline mode
            tasks = getLS('tasks', []);
            renderTasks();
        }
    </script>
</body>

</html>